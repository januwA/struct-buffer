!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.StructBuffer=t():e.StructBuffer=t()}(this,(function(){return(()=>{"use strict";var e={24:(e,t,s)=>{s.r(t),s.d(t,{BYTE:()=>f,DWORD:()=>N,QWORD:()=>h,StructBuffer:()=>z,WORD:()=>d,char:()=>i,display:()=>B,double:()=>p,float:()=>o,int16_t:()=>u,int32_t:()=>y,int64_t:()=>m,int8_t:()=>c,sizeof:()=>O,string_t:()=>a,uint16_t:()=>g,uint32_t:()=>_,uint64_t:()=>x,uint8_t:()=>l});class r{constructor(e,t){this.typeName=t,this.deeps=[],this.deeps.push(e);const s=new Proxy(this,{get:(e,t)=>t in e?e[t]:(t=t.toString(),/\d+/.test(t)&&e.deeps.push(parseInt(t)),s)});return s}}class n extends Array{constructor(){super(),this.deeps=[];return new Proxy(this,{get(e,t){if(t in e)return e[t];if(t=t.toString(),/\d+/.test(t)){const s=new r(parseInt(t),e.typeName);return Object.setPrototypeOf(s,n.prototype),s}throw new Error(`StructBuffer: (${e.typeName.toUpperCase()}) type error.`)}})}get isList(){return!!this.deeps.length}get count(){return this.deeps.reduce(((e,t)=>e*t),1)}}const i=new class extends n{constructor(){super(...arguments),this.typeName="char"}},a=new class extends n{constructor(){super(...arguments),this.typeName="string_t"}},o=new class extends n{constructor(){super(...arguments),this.typeName="float"}},p=new class extends n{constructor(){super(...arguments),this.typeName="double"}},c=new class extends n{constructor(){super(...arguments),this.typeName="int8_t"}},u=new class extends n{constructor(){super(...arguments),this.typeName="int16_t"}},y=new class extends n{constructor(){super(...arguments),this.typeName="int32_t"}},m=new class extends n{constructor(){super(...arguments),this.typeName="int64_t"}},f=new class extends n{constructor(){super(...arguments),this.typeName="byte"}},d=new class extends n{constructor(){super(...arguments),this.typeName="word"}},N=new class extends n{constructor(){super(...arguments),this.typeName="dword"}},h=new class extends n{constructor(){super(...arguments),this.typeName="qword"}},l=new class extends n{constructor(){super(...arguments),this.typeName="uint8_t"}},g=new class extends n{constructor(){super(...arguments),this.typeName="uint16_t"}},_=new class extends n{constructor(){super(...arguments),this.typeName="uint32_t"}},x=new class extends n{constructor(){super(...arguments),this.typeName="uint64_t"}},w=[c.typeName,u.typeName,y.typeName,m.typeName,l.typeName,g.typeName,_.typeName,x.typeName,f.typeName,d.typeName,N.typeName,h.typeName,o.typeName,p.typeName,i.typeName,a.typeName];var b;function D(e,t,s=!1){let r=e;s&&"string"==typeof r&&(r=r.split(""));for(let e=t.length-1;e>=1;e--){const n=e===t.length-1,i=t[e];r=r.reduce(((e,t,s)=>(s%i==0&&e.push([]),e[e.length-1].push(t),e)),[]),s&&n&&(r=r.map((e=>e.join(""))))}return r}function U(e,t){switch(e.typeName){case c.typeName:t[c.typeName]&&t[c.typeName]({get:"getInt8",set:"setInt8",size:b.BYTE});break;case u.typeName:t[u.typeName]&&t[u.typeName]({get:"getInt16",set:"setInt16",size:b.WORD});break;case y.typeName:t[y.typeName]&&t[y.typeName]({get:"getInt32",set:"setInt32",size:b.DWORD});break;case m.typeName:t[m.typeName]&&t[m.typeName]({get:"getBigInt64",set:"setBigInt64",size:b.QWORD});break;case f.typeName:t[f.typeName]&&t[f.typeName]({get:"getUint8",set:"setUint8",size:b.BYTE});break;case l.typeName:t[l.typeName]&&t[l.typeName]({get:"getUint8",set:"setUint8",size:b.BYTE});break;case d.typeName:t[d.typeName]&&t[d.typeName]({get:"getUint16",set:"setUint16",size:b.WORD});break;case g.typeName:t[g.typeName]&&t[g.typeName]({get:"getUint16",set:"setUint16",size:b.WORD});break;case N.typeName:t[N.typeName]&&t[N.typeName]({get:"getUint32",set:"setUint32",size:b.DWORD});break;case _.typeName:t[_.typeName]&&t[_.typeName]({get:"getUint32",set:"setUint32",size:b.DWORD});break;case h.typeName:t[h.typeName]&&t[h.typeName]({get:"getBigUint64",set:"setBigUint64",size:b.QWORD});break;case x.typeName:t[x.typeName]&&t[x.typeName]({get:"getBigUint64",set:"setBigUint64",size:b.QWORD});break;case o.typeName:t[o.typeName]&&t[o.typeName]({get:"getFloat32",set:"setFloat32",size:b.DWORD});break;case p.typeName:t[p.typeName]&&t[p.typeName]({get:"getFloat64",set:"setFloat64",size:b.QWORD});break;case i.typeName:t[i.typeName]&&t[i.typeName]({get:"getUint8",set:"setUint8",size:b.BYTE});break;case a.typeName:t[a.typeName]&&t[a.typeName]({get:"getUint8",set:"setUint8",size:b.BYTE})}}function O(e){let t=0;return U(e,w.reduce(((e,s)=>(e[s]=e=>t=e.size,e)),{})),e.isList?t*e.count:t}function B(e,t,s=!0,r=!1){let n=0;let c=null;const u=w.filter((e=>e!==i.typeName||e!==a.typeName)).reduce(((i,a)=>(i[a]=i=>c=function(i,a){let c=[];for(;;)try{let u=e[i](n,r);s&&t!==o&&t!==p&&(u=u.toString(16).toUpperCase().padStart(2*a,"0")),c.push({offset:n,value:u}),n+=a}catch(e){break}return c}(i.get,i.size),i)),{});if(U(t,u),!c)throw new Error(`StructBuffer: display does not support (${t}) type.`);return c}!function(e){e[e.BYTE=1]="BYTE",e[e.WORD=2]="WORD",e[e.DWORD=4]="DWORD",e[e.QWORD=8]="QWORD"}(b||(b={}));class z{constructor(e){this.struct=e,this._textDecode=new TextDecoder,this._textEncoder=new TextEncoder,this._offset=0}get textDecode(){return this._textDecode}set textDecode(e){this._textDecode=e}_decode(e){return this.textDecode.decode(e)}get textEncoder(){return this._textEncoder}set textEncoder(e){this._textEncoder=e}_encode(e){return this.textEncoder.encode(e)}get byteLength(){let e=0;for(const t in this.struct){e+=O(this.struct[t])}return e}decode(e,t=!1){const s={};for(const r in this.struct){const n=this.struct[r],o=this._readValue.bind(this,e,n,t),p=w.reduce(((t,p)=>(t[p]=t=>{p===i.typeName||p===a.typeName?s[r]=this._readBytes(e,n):s[r]=o(t.get,t.size)},t)),{});U(n,p)}return this._offset=0,s}encode(e,t=!1){const s=new DataView(new ArrayBuffer(this.byteLength));for(const r in this.struct){let n=this.struct[r];const o=e[r],p=this._writeValue.bind(this,s,n,t,o),c=w.reduce(((e,t)=>(e[t]=e=>{t===i.typeName||t===a.typeName?this._writeBytes(s,n,o):p(e.set,e.size)},e)),{});U(n,c)}return this._offset=0,s}_readBytes(e,t){let s;const r=t.typeName===a.typeName;if(t.isList){s=[];for(let r=0;r<t.count;r++)s.push(e.getUint8(this._offset)),this._offset++;return r&&(s=this._decode(new Uint8Array(s)),t.deeps.length<2)||(s=D(s,t.deeps,r)),s}return s=e.getUint8(this._offset),r&&(s=this._decode(new Uint8Array([s]))),this._offset++,s}_writeBytes(e,t,s){const r=t.typeName===a.typeName;if(t.isList){Array.isArray(s)&&(s=s.flat(),r&&(s=s.join(""))),r&&(s=this._encode(s));for(let r=0;r<t.count;r++){let t=s[r];void 0===t&&(t=0),e.setUint8(this._offset,t),this._offset++}}else r&&(s=this._encode(s)[0]),e.setUint8(this._offset,s),this._offset++}_readValue(e,t,s,r,n){let i;if(t.isList){i=[];for(let a=0;a<t.count;a++)i.push(e[r](this._offset,s)),this._offset+=n;i=D(i,t.deeps)}else i=e[r](this._offset,s),this._offset+=n;return i}_writeValue(e,t,s,r,n,i){if(t.isList&&Array.isArray(r)){r=r.flat();for(let a=0;a<t.count;a++)e[n](this._offset,r[a],s),this._offset+=i}else e[n](this._offset,r,s),this._offset+=i}}}},t={};function s(r){if(t[r])return t[r].exports;var n=t[r]={exports:{}};return e[r](n,n.exports,s),n.exports}return s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s(24)})()}));